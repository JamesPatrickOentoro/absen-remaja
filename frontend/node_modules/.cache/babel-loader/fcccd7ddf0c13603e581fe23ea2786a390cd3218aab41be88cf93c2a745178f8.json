{"ast":null,"code":"import * as XLSX from 'xlsx';\nimport axios from 'axios';\nexport default {\n  name: 'StudentAttendance',\n  data() {\n    return {\n      absents: [],\n      filterName: '',\n      filterStatus: '',\n      filterDate: ''\n    };\n  },\n  mounted() {\n    this.fetchAbsents();\n  },\n  methods: {\n    async fetchAbsents() {\n      try {\n        // Pastikan this.filterDate adalah string tanggal yang valid\n        const date = new Date(this.filterDate);\n\n        // Memastikan tanggal valid\n        if (isNaN(date)) {\n          throw new Error(\"Invalid Date\");\n        }\n\n        // Format tanggal menjadi YYYY-MM-DD\n        const formattedDate = date.toISOString().split('T')[0];\n        const response = await axios.get('absen/filter-absent-data', {\n          params: {\n            status: this.filterStatus,\n            nama: this.filterName,\n            tanggal: formattedDate\n          }\n        });\n        console.log(formattedDate); // Memastikan tanggal diformat dengan benar\n        this.absents = response.data;\n      } catch (error) {\n        console.error('Error fetching absents:', error);\n      }\n    },\n    search() {\n      this.fetchAbsents();\n    },\n    saveToExcel(data) {\n      const ws = XLSX.utils.json_to_sheet(data);\n      const wb = XLSX.utils.book_new();\n      XLSX.utils.book_append_sheet(wb, ws, 'Sheet1');\n      XLSX.writeFile(wb, 'data-absensi.xlsx');\n    },\n    generateSheet() {\n      this.saveToExcel(this.absents);\n    }\n  }\n};","map":{"version":3,"names":["XLSX","axios","name","data","absents","filterName","filterStatus","filterDate","mounted","fetchAbsents","methods","date","Date","isNaN","Error","formattedDate","toISOString","split","response","get","params","status","nama","tanggal","console","log","error","search","saveToExcel","ws","utils","json_to_sheet","wb","book_new","book_append_sheet","writeFile","generateSheet"],"sources":["D:\\New folder\\absen-remaja\\frontend\\src\\components\\StudentAttendance.vue"],"sourcesContent":["<template>\r\n    <div class=\"header-attendance-container\">\r\n        <div class=\"attend\">\r\n            <h3>Attendance</h3>\r\n            <div class=\"attendance-filterbar\">\r\n                <div class=\"attendance-item\">\r\n                    <div class=\"attend-items\">\r\n                        <div class=\"a-item\">\r\n                            <label>Name</label>\r\n                            <input type=\"text\" v-model=\"filterName\">\r\n                        </div>\r\n                        <div class=\"a-item\">\r\n                            <label>Date</label>\r\n                            <input class=\"button\" type=\"date\" v-model=\"filterDate\">\r\n                        </div>\r\n                        <div class=\"a-item\">\r\n                            <label>Status</label>\r\n                            <select class=\"form-select\" v-model=\"filterStatus\" @change=\"filterData\">\r\n                                <option value=\"\">All</option>\r\n                                <option value=\"active\">Active</option>\r\n                                <option value=\"inactive\">Inactive</option>\r\n                            </select>\r\n                        </div>\r\n                        <div class=\"a-item\">\r\n                            <button class=\"button\" @click=\"search\">Search</button>\r\n                            <button class=\"button\" @click=\"generateSheet\">Generate Sheet</button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <div class=\"table-container-attendance\">\r\n                <table class=\"table-sticky\">\r\n                    <thead style=\"position: sticky; top: 0; background: #ccc;\">\r\n                        <tr>\r\n                            <th scope=\"col\">Student Name</th>\r\n                            <th scope=\"col\">Student ID</th>\r\n                            <th scope=\"col\">Date/Time</th>\r\n                            <th scope=\"col\">Status</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        <tr v-for=\"(absent, i) in absents\" :key=\"i\">\r\n                            <td>{{ absent.nama }}</td>\r\n                            <td>{{ absent.id_jemaat }}</td>\r\n                            <td>{{ absent.waktu_absen }}</td>\r\n                            <td>{{ absent.status }}</td>\r\n                        </tr>\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport * as XLSX from 'xlsx';\r\nimport axios from 'axios';\r\n\r\nexport default {\r\n    name: 'StudentAttendance',\r\n    data() {\r\n        return {\r\n            absents: [],\r\n            filterName: '',\r\n            filterStatus: '',\r\n            filterDate: '',\r\n        };\r\n    },\r\n    mounted() {\r\n        this.fetchAbsents();\r\n    },\r\n    methods: {\r\n        async fetchAbsents() {\r\n            try {\r\n                // Pastikan this.filterDate adalah string tanggal yang valid\r\n                const date = new Date(this.filterDate);\r\n\r\n                // Memastikan tanggal valid\r\n                if (isNaN(date)) {\r\n                    throw new Error(\"Invalid Date\");\r\n                }\r\n\r\n                // Format tanggal menjadi YYYY-MM-DD\r\n                const formattedDate = date.toISOString().split('T')[0];\r\n\r\n                const response = await axios.get('absen/filter-absent-data', {\r\n                    params: {\r\n                        status: this.filterStatus,\r\n                        nama: this.filterName,\r\n                        tanggal: formattedDate,\r\n                    }\r\n                });\r\n\r\n                console.log(formattedDate); // Memastikan tanggal diformat dengan benar\r\n                this.absents = response.data;\r\n            } catch (error) {\r\n                console.error('Error fetching absents:', error);\r\n            }\r\n        },\r\n        search() {\r\n            this.fetchAbsents();\r\n        },\r\n        saveToExcel(data) {\r\n            const ws = XLSX.utils.json_to_sheet(data);\r\n            const wb = XLSX.utils.book_new();\r\n            XLSX.utils.book_append_sheet(wb, ws, 'Sheet1');\r\n            XLSX.writeFile(wb, 'data-absensi.xlsx');\r\n        },\r\n        generateSheet() {\r\n            this.saveToExcel(this.absents);\r\n        },\r\n    },\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.header-attendance-container {\r\n    padding: 20px;\r\n    background-color: #f9f9f9;\r\n    border-radius: 10px;\r\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\r\n    margin: auto;\r\n    min-width: 80%;\r\n}\r\n\r\n.attend {\r\n    margin: 0 auto;\r\n}\r\n\r\n.attendance-filterbar {\r\n    margin-bottom: 20px;\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    gap: 15px;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n}\r\n\r\n.attendance-item {\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    gap: 15px;\r\n}\r\n\r\n.attend-items {\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    gap: 15px;\r\n}\r\n\r\n.a-item {\r\n    flex: 1;\r\n    min-width: 150px;\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 5px;\r\n}\r\n\r\n.a-item label {\r\n    font-weight: bold;\r\n}\r\n\r\n.button {\r\n    border-radius: 5px;\r\n    border: none;\r\n    padding: 8px 15px;\r\n    background-color: #007bff;\r\n    color: white;\r\n    cursor: pointer;\r\n    transition: background-color 0.3s;\r\n}\r\n\r\n.button:hover {\r\n    background-color: #0056b3;\r\n}\r\n\r\n.table-container-attendance {\r\n    /* overflow-x: auto; */\r\n    max-height: 60vh;\r\n    overflow-y: auto;\r\n}\r\n\r\n.table-sticky {\r\n    width: 100%;\r\n    border-collapse: collapse;\r\n}\r\n\r\n.table-sticky th,\r\n.table-sticky td {\r\n    padding: 12px 15px;\r\n    border: 1px solid #ddd;\r\n    text-align: left;\r\n}\r\n\r\ninput {\r\n    border-radius: 8px;\r\n}\r\n\r\n.table-sticky th {\r\n    background-color: #f4f4f4;\r\n}\r\n\r\n.table-sticky tbody tr:nth-child(even) {\r\n    background-color: #f9f9f9;\r\n}\r\n\r\n.table-sticky tbody tr:hover {\r\n    background-color: #f1f1f1;\r\n}\r\n\r\n@media (max-width: 768px) {\r\n    .header-attendance-container {\r\n        padding: 12px;\r\n        margin-top: 20px;\r\n    }\r\n\r\n    .attendance-filterbar {\r\n        flex-direction: row;\r\n        gap: 12px;\r\n    }\r\n\r\n    .attend-items {\r\n        flex-direction: row;\r\n        gap: 10px;\r\n    }\r\n\r\n    .attend h3 {\r\n        margin-bottom: 25px;\r\n    }\r\n\r\n    .a-item {\r\n        width: 100%;\r\n    }\r\n\r\n    .table-container-attendance {\r\n        /* overflow-x: auto; */\r\n        max-height: 40vh;\r\n        overflow-y: auto;\r\n    }\r\n}\r\n</style>\r\n"],"mappings":"AAwDA,OAAO,KAAKA,IAAG,MAAO,MAAM;AAC5B,OAAOC,KAAI,MAAO,OAAO;AAEzB,eAAe;EACXC,IAAI,EAAE,mBAAmB;EACzBC,IAAIA,CAAA,EAAG;IACH,OAAO;MACHC,OAAO,EAAE,EAAE;MACXC,UAAU,EAAE,EAAE;MACdC,YAAY,EAAE,EAAE;MAChBC,UAAU,EAAE;IAChB,CAAC;EACL,CAAC;EACDC,OAAOA,CAAA,EAAG;IACN,IAAI,CAACC,YAAY,CAAC,CAAC;EACvB,CAAC;EACDC,OAAO,EAAE;IACL,MAAMD,YAAYA,CAAA,EAAG;MACjB,IAAI;QACA;QACA,MAAME,IAAG,GAAI,IAAIC,IAAI,CAAC,IAAI,CAACL,UAAU,CAAC;;QAEtC;QACA,IAAIM,KAAK,CAACF,IAAI,CAAC,EAAE;UACb,MAAM,IAAIG,KAAK,CAAC,cAAc,CAAC;QACnC;;QAEA;QACA,MAAMC,aAAY,GAAIJ,IAAI,CAACK,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;QAEtD,MAAMC,QAAO,GAAI,MAAMjB,KAAK,CAACkB,GAAG,CAAC,0BAA0B,EAAE;UACzDC,MAAM,EAAE;YACJC,MAAM,EAAE,IAAI,CAACf,YAAY;YACzBgB,IAAI,EAAE,IAAI,CAACjB,UAAU;YACrBkB,OAAO,EAAER;UACb;QACJ,CAAC,CAAC;QAEFS,OAAO,CAACC,GAAG,CAACV,aAAa,CAAC,EAAE;QAC5B,IAAI,CAACX,OAAM,GAAIc,QAAQ,CAACf,IAAI;MAChC,EAAE,OAAOuB,KAAK,EAAE;QACZF,OAAO,CAACE,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;MACnD;IACJ,CAAC;IACDC,MAAMA,CAAA,EAAG;MACL,IAAI,CAAClB,YAAY,CAAC,CAAC;IACvB,CAAC;IACDmB,WAAWA,CAACzB,IAAI,EAAE;MACd,MAAM0B,EAAC,GAAI7B,IAAI,CAAC8B,KAAK,CAACC,aAAa,CAAC5B,IAAI,CAAC;MACzC,MAAM6B,EAAC,GAAIhC,IAAI,CAAC8B,KAAK,CAACG,QAAQ,CAAC,CAAC;MAChCjC,IAAI,CAAC8B,KAAK,CAACI,iBAAiB,CAACF,EAAE,EAAEH,EAAE,EAAE,QAAQ,CAAC;MAC9C7B,IAAI,CAACmC,SAAS,CAACH,EAAE,EAAE,mBAAmB,CAAC;IAC3C,CAAC;IACDI,aAAaA,CAAA,EAAG;MACZ,IAAI,CAACR,WAAW,CAAC,IAAI,CAACxB,OAAO,CAAC;IAClC;EACJ;AACJ"},"metadata":{},"sourceType":"module","externalDependencies":[]}